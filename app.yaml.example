runtime: python312

entrypoint: gunicorn -b :$PORT adviser_allocation.main:app

instance_class: F1

automatic_scaling:
  min_instances: 0
  max_instances: 10

env_variables:
  # Python path for src/ layout
  PYTHONPATH: src
  # Secret Manager references (App Engine will fetch these automatically)
  HUBSPOT_TOKEN: projects/pivot-digital-466902/secrets/HUBSPOT_TOKEN/versions/latest
  EH_CLIENT_ID: projects/pivot-digital-466902/secrets/EH_CLIENT_ID/versions/latest
  EH_CLIENT_SECRET: projects/pivot-digital-466902/secrets/EH_CLIENT_SECRET/versions/latest
  SESSION_SECRET: projects/pivot-digital-466902/secrets/HUBSPOT_SESSION_SECRET/versions/latest
  ADMIN_USERNAME: projects/pivot-digital-466902/secrets/ADMIN_USERNAME/versions/latest
  ADMIN_PASSWORD: projects/pivot-digital-466902/secrets/ADMIN_PASSWORD/versions/latest
  # Google Chat webhook for allocation alerts
  CHAT_WEBHOOK_URL: projects/pivot-digital-466902/secrets/CHAT_WEBHOOK_URL/versions/latest
  # Non-secret environment variables
  USE_FIRESTORE: "true"
  EH_SCOPES: "urn:mainapp:leave_requests:read"
  REDIRECT_URI: "https://adviser-allocation-307314618542.australia-southeast1.run.app/auth/callback"
  HUBSPOT_PORTAL_ID: "47011873"
